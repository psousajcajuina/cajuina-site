---
import MapaDistribuidores from '@/components/react/MapaDistribuidores';
import type { Distribuidor } from '@/types';
import SwiperLayout from './ui/SwiperLayout.astro';
import { getCollection } from 'astro:content';

// Buscar distribuidores da coleção
const distribuidoresCollection = await getCollection('distribuidor');

// Filtrar apenas os ativos e mapear para o formato esperado
const distribuidores: Distribuidor[] = distribuidoresCollection
  .filter((dist) => dist.data.active)
  .map((dist, index) => ({
    id: index + 1,
    nome: dist.data.nome,
    endereco: dist.data.endereco,
    telefone: dist.data.telefone,
    lat: dist.data.lat,
    lng: dist.data.lng,
  }));
---

<SwiperLayout>
  <MapaDistribuidores client:only="react" distribuidores={distribuidores} />
</SwiperLayout>
